# Fail2Ban filter to match web requests for selected URLs that don't exist
#

#[INCLUDES]

# Load regexes for filtering
#before = botsearch-common.conf

[Definition]

#failregex = ^<HOST> \- \S+ \[\] \"(GET|POST|HEAD) \/<block> \S+\" 404 .+$
#            ^ \[error\] \d+#\d+: \*\d+ (\S+ )?\"\S+\" (failed|is not found) \(2\: No such file or directory\), client\: <HOST>\, server\: \S*\, request: \"(GET|POST|HEAD) \/<block> \S+\"\, .*?$

#2021/05/20 05:20:16 [error] 30436#30436: *24170 access forbidden by rule, client: 85.201.175.168, server: www.elivecd.org, request: "GET /404 HTTP/1.1", host: "www.elivecd.org"
#failregex = ^ \[error\] \d+#\d+: .* forbidden .*, client: <HOST>, .*$

#2021/05/20 06:12:04 [error] 13788#13788: *25920 FastCGI sent in stderr: "PHP message: BOT WARNING: visitor used the honeypot: 191.92.148.122, you should ban it for long time" while reading response header from upstream, client: 191.92.148.122, server: www.elivecd.org, request: "POST /download/stable/ HTTP/2.0", upstream: "fastcgi://127.0.0.1:9000", host: "www.elivecd.org", referrer: "https://www.elivecd.org/download/stable/"
failregex = ^ \[error\] \d+#\d+: .*started download of elive from: <HOST>, .*$


ignoreregex = 

